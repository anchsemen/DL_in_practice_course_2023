## **Отчёт**

*By Семён Кирсанов, Данил Кладницкий, Никита Ценцеря, Виктор Пахолков*

### **Данные:**

Для обучения был взят готовый датасет “russian-traffic-signs-recognition Image Dataset”, доступный на Roboflow (<https://universe.roboflow.com/mguogareva/russian-traffic-signs-recognition/dataset/3>). 
Датасет состоит из 2390 изображений российских дорожных знаков в различных погодных, сезонных и географических условиях, при различном освещении. Датасет уже является размеченным, прямоугольником выделено расположение знаков на фотографиях, с указанием одного из 165 классов, которыми обозначены различные виды дорожных знаков. 
На одной фотографии может быть более одной области выделения и более одного дорожного знака соответственно. 1632 изображение были в тренировочном сете (68% датасета), 503 в валидационном (21%) и 255 в тестовом (11%). 
Данные были доступны уже в удобном формате с txt аннотациями и YAML config’ами сразу для YOLOv8.

*Примеры  изображений из данных:*

![Fig 1](https://github.com/danilkladnitsky/computer-vision-course-2023/assets/56613496/51829e7c-396d-4bc3-94e7-d6694800fe39)

*Fig. 1 Пример изображения из данных (№1)* 

![Fig 2](https://github.com/danilkladnitsky/computer-vision-course-2023/assets/56613496/8383b0fe-5da0-4101-9926-3fffc1e4b296)

*Fig. 2 Пример изображения из данных (№2)* 



### **Модель**: 

Для задачи распознавания дорожных знаков использовалась модель YOLOv8 (<https://github.com/ultralytics/ultralytics>). 

YOLOv8 — это архитектура нейронной сети для обнаружения объектов, разработанная командой исследователей из Google AI. YOLOv8 работает, разделяя изображение на сетку, а затем предсказывая для каждого блока сетки, есть ли на нем объект и какой именно. Она делает это с помощью двух отдельных сетей: детектора и классификатора. 
Детектор отвечает за прогнозирование вероятности того, что на блоке сетки есть объект. Он делает это, используя комбинацию сверточных слоев и функций активации. Классификатор отвечает за прогнозирование класса объекта, если он есть на блоке сетки. Он так же делает это, используя комбинацию сверточных слоев и функций активации.

YOLO использует архитектуру DarkNet в качестве детектора. DarkNet — это глубокая нейронная сеть, которая была специально разработана для задач обнаружения объектов. В качестве классификатора используется архитектура FPN, которая позволяет классификатору получать доступ к информации из разных уровней сетки.

### **Рассматривались 3 вариации архитектуры YOLOv8:**

\- YOLOv8n (nano)

\- YOLOv8s (small)

\- YOLOv8m (medium)

Они отличаются друг от друга размером модели, количеством параметров и производительностью.

*YOLOv8n* — это самая маленькая вариация, которая имеет всего 10,2 миллиона параметров. Она основана на архитектуре DarkNet-Tiny, которая является упрощенной версией DarkNet-53. YOLOv8n обычно не может похвастаться крайне высокой точностью, зато может обеспечить высокую скорость работы.

*YOLOv8s* — это средняя вариация, которая имеет 21,3 миллиона параметров. Она основана на архитектуре DarkNet-S, которая является уменьшенной версией DarkNet-53. YOLOv8s обеспечивает более высокую точность, чем YOLOv8n, но все еще сохраняет относительно высокую скорость работы.

*YOLOv8m* — это самая большая вариация, которая имеет 61,3 миллиона параметров. Она основана на архитектуре DarkNet-53. YOLOv8m обеспечивает самую высокую точность, но самую низкую скорость работы.


### **Проведенные эксперименты**:

Обучение каждой из вариаций YOLOv8 с разными гиперпараметрами проходило в 30 эпох.

Гиперпараметрами, которые мы меняли для тюнинга, были размер изображения, которое сеть получает на входе (640 или 1280) и оптимизатор (мы пробовали следующие варианты: SGD, Adam, Adamax, AdamW, NAdam, RAdam, RMSProp):

![fig 3](https://github.com/danilkladnitsky/computer-vision-course-2023/assets/56613496/fe4c0eb9-4b03-43c3-9baa-b189416b4e83)

*Fig. 3 График функции потерь классификации в процессе обучения для разных комбинаций*

Метрика, использовавшаяся для оценки изменений - mAP50 (Mean Average Precision at 50%). Она измеряет, насколько точно детектор обнаруживает объекты, когда их уверенность составляет 50% и была выбрана, поскольку она является релевантной для задачи классификации знаков дорожного движения. Задача классификации знаков дорожного движения заключается в том, чтобы определить, присутствует ли на изображении знак дорожного движения, и если да, то какой именно. Метрика mAP50 измеряет точность детектора в выполнении этой задачи.

### **Результаты:**

В ходе проведенных нами экспериментов было установлено, что конфигурация модели YOLOv8m с параметрами: imgsz=1280 и оптимизатором RAdam даёт самую большую точность по mAP50 (77%) (и классическому precision - 76% - как и всем остальным возможным метрикам):

![fig 4](https://github.com/danilkladnitsky/computer-vision-course-2023/assets/56613496/2d29d8d0-e959-48e3-b470-0038934933c4)

*Fig. 4 График* mAP50 для *ряда отобранных моделей*

![fig 5](https://github.com/danilkladnitsky/computer-vision-course-2023/assets/56613496/71edff39-d3b4-477b-aa0f-62f5b8f2f0df)

*Fig. 5 График precision для ряда отобранных моделей*



Однако, на обучение подобной модели требуется крайне много ресурсов, в то время как модель YOLOv8s с параметрами imgsz=1280 и оптимизатором SGD совершенно незначительно уступает в точности, выдавая mAP50 в 75,7%, при этом тратя ~ в 1.5 раза меньше вычислительных ресурсов.

![fig 6](https://github.com/danilkladnitsky/computer-vision-course-2023/assets/56613496/0db79535-e02f-4d3c-95a1-3a5e2b509e04)

*Fig. 6 График* mAP50 *для* YOLOv8m (1280, RAdam) vs. YOLOv8s (1280, SGD)

![fig 7](https://github.com/danilkladnitsky/computer-vision-course-2023/assets/56613496/16ebadd4-22ae-43e1-b426-ce75114b33cf)

*Fig. 7 График утилизации GPU для* YOLOv8m (1280, RAdam) vs. YOLOv8s (1280, SGD)

![fig 8](https://github.com/danilkladnitsky/computer-vision-course-2023/assets/56613496/be040d3c-df78-4c3c-90f4-3cdca9fb10d2)

*Fig. 8 График аллокации памяти GPU для* YOLOv8m (1280, RAdam) vs. YOLOv8s (1280, SGD)

![fig 9](https://github.com/danilkladnitsky/computer-vision-course-2023/assets/56613496/6b76f78c-b2c9-42ca-9785-5acc785a388a)

*Fig. 9 График утилизации CPU для* YOLOv8m (1280, RAdam) vs. YOLOv8s (1280, SGD)
